<div
  class="automata-shell"
  [class.automata-shell--immersive]="uiState.isImmersive"
  [class.automata-shell--mobile]="uiState.isMobile"
>
  <header class="automata-shell__header">
    <div class="brand" aria-label="AutomataJS">
      <img class="brand-logo" src="assets/automatajs.svg" alt="AutomataJS logo" />
      <span>AutomataJS</span>
    </div>
    <div class="header-actions">
      <button type="button" class="header-button" (click)="openAbout()">About</button>
      <button
        type="button"
        class="header-button header-button--primary"
        (click)="uiState.isControlPanelOpen ? closePanel() : openPanel()"
      >
        {{ uiState.isControlPanelOpen ? 'Hide controls' : 'Show controls' }}
      </button>
    </div>
  </header>

  <div class="automata-shell__main">
    <div class="canvas-pane">
      <div class="canvas-pane__surface">
        <app-automata-canvas></app-automata-canvas>
      </div>

      <app-automata-transport-bar
        class="automata-shell__transport"
        [class.automata-shell__transport--immersive]="uiState.isImmersive"
        [class.automata-shell__transport--hidden]="uiState.isImmersive && !isImmersiveTransportVisible"
        [status]="uiState.status"
        [speed]="simulationConfig.speed"
        (mouseenter)="onTransportInteraction()"
        (focusin)="onTransportInteraction()"
        (play)="onPlay()"
        (pause)="onPause()"
        (reset)="onReset()"
        (step)="onStep()"
        (speedChange)="onSpeedChange($event)"
      ></app-automata-transport-bar>
    </div>

    <section
      class="controls-pane"
      [class.controls-pane--collapsed]="!uiState.isControlPanelOpen && !uiState.isMobile"
      [class.controls-pane--mobile-hidden]="uiState.isMobile && !uiState.isControlPanelOpen"
    >
      <div class="panel__body">
        <div class="panel__header">
          <div>
            <p class="panel__eyebrow">Control center</p>
          </div>
          <button type="button" class="panel__close" (click)="closePanel()">Close</button>
        </div>

        <div class="panel__content">
          <app-automata-control
            [config]="simulationConfig"
            [status]="uiState.status"
            [uiState]="uiState"
            (configChange)="onConfigChange($event)"
            (statusChange)="onStatusChange($event)"
            (uiStateChange)="onUiStateChange($event)"
          ></app-automata-control>
        </div>

        <div class="panel__handle" *ngIf="uiState.isMobile"></div>
      </div>
    </section>
  </div>

  <div class="automata-shell__about" *ngIf="isAboutOpen">
    <div class="about-card" role="dialog" aria-modal="true" aria-label="About AutomataJS">
      <button type="button" class="about-card__close" (click)="closeAbout()">
        <mat-icon>close</mat-icon>
      </button>
      <h3>About AutomataJS</h3>
      <p>
        AutomataJS is a GPU-accelerated playground for iterating on cellular automata without touching GLSL. Every
        simulation runs inside shaders so you can pause, recolor, zoom, and resume at full speed.
      </p>
      <p>
        Responsive controls, touch-friendly sliders, and curated presets help you explore emergent behavior on desktop or
        mobile. Save palettes, tweak rules, and capture high-resolution stills as you experiment.
      </p>
      <a
        class="about-card__link"
        href="https://github.com/bisignam/automatajs"
        target="_blank"
        rel="noopener"
      >
        View project on GitHub
      </a>
    </div>
  </div>
</div>
